CREATE TABLE Patient(
    IID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    CIN VARCHAR(100) NOT NULL UNIQUE,
    Name VARCHAR(100) NOT NULL,
    Sex VARCHAR(1) NOT NULL CHECK(Sex IN ('M','F')),
    Birth DATE NOT NULL,
    Blood_group VARCHAR(10) NOT NULL,
    Phone VARCHAR(20)
);

CREATE TABLE Contact_Location(
    CLID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    City VARCHAR(100) NOT NULL,
    Province VARCHAR(100) NOT NULL,
    Street VARCHAR(500) NOT NULL,
    Number VARCHAR(10) NOT NULL,
    Postal_code VARCHAR(10) NOT NULL,
    Phone VARCHAR(20)
);

CREATE TABLE Have(
    CLID INT NOT NULL,
    IID INT NOT NULL,
    PRIMARY KEY (CLID, IID),
    FOREIGN KEY (CLID) REFERENCES Contact_Location(CLID) ON DELETE CASCADE,
    FOREIGN KEY (IID) REFERENCES Patient(IID) ON DELETE CASCADE
);

CREATE TABLE Insurance(
    InsID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    Ins_type VARCHAR(10) CHECK (Ins_type in ('CNOPS', 'CNSS', 'RAMED', 'private') OR Ins_type IS NULL)
);

CREATE TABLE Expense(
    ExID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    InsID INT,
    Total DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (InsID) REFERENCES Insurance(InsID) ON DELETE SET NULL
);

CREATE TABLE Covers(
    InsID INT NOT NULL,
    IID INT NOT NULL,
    PRIMARY KEY (ExID, IID),
    FOREIGN KEY (ExID) REFERENCES Expense(ExID) ON DELETE CASCADE,
    FOREIGN KEY (IID) REFERENCES Patient(IID) ON DELETE CASCADE
);

CREATE TABLE Staff(
    Staff_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(100) NOT NULL,
    Status VARCHAR(20) NOT NULL
);

CREATE TABLE Practioner(
    Staff_ID INT NOT NULL PRIMARY KEY,
    License_Number INT NOT NULL,
    Specialty VARCHAR(100) NOT NULL,
    FOREIGN KEY (Staff_ID) REFERENCES Staff(Staff_ID) ON DELETE CASCADE
);

CREATE TABLE Caregiving(
    Staff_ID INT NOT NULL PRIMARY KEY,
    Grade VARCHAR(50) NOT NULL,
    Ward VARCHAR(100) NOT NULL,
    FOREIGN KEY (Staff_ID) REFERENCES Staff(Staff_ID) ON DELETE CASCADE
);

CREATE TABLE Technical(
    Staff_ID INT NOT NULL PRIMARY KEY,
    Modality VARCHAR(100) NOT NULL,
    Certifications VARCHAR(100) NOT NULL,
    FOREIGN KEY (Staff_ID) REFERENCES Staff(Staff_ID) ON DELETE CASCADE
);